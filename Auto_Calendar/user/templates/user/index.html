<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CIS Auto Calendar</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
</head>
<body>

    <div class="position-relative border border-2 border-dark">
        <img src = "{% static 'img/cisview2.jpg' %}" class = "img-fluid" style = "opacity: 0.6">
        <h1 class = "position-absolute top-50 start-50 translate-middle border border-4 border-dark p-4 display-2 text-center">
        CIS AUTO CALENDAR
        </h1>
    </div>

    </br>

    <div id = "inputDiv" style = "display: none ;">
        <div class = "row justify-content-center" >
            <div class = "col-auto" id = "step2and3" style = "display: block">
                <h3>Step 2: Input your schedule in the table below</h3>
                <p>Leave any free periods blank</p>
                <form id = "userScheduleInput" method = "post" name = "userform">
                    {% csrf_token %}
                    <span class="badge bg-primary" id = "dateRangeText"></span>
                    <div id = "tableInput">

                    </div>
                    <span class="badge bg-secondary">Cycle Day Events are the events that you see at the top of your calendar day. eg. "A4" or "B3"</span>
                    <div class="form-check">
                        <input id="userImportDays" class="form-check-input" type="checkbox" value="" >
                        <label class="form-check-label" for="userImportDays">Import Cycle Day Events</label>
                    </div>
                    <div style = "padding-top:30px">
                        <h3>Step 3: Import to Google Calendar</h3>
                        <p>Clicking this button will create an event for each class according to the schedule you input above.</p>
                        <p>The events <b>will not all show up immediately</b> and the process may take up to 30 seconds.</p>
                        <p>Make sure to reload your calendar if events are still missing.</p>
                        <button id = "userSubmitButton" class="btn btn-primary" type="button" onclick="submitForm()">Import to Google Calendar</button>
                    </div>

                </form>
                </br>
            </div>
            <div class = "col-auto" id = "step4" style = "display: none">
                <h3 id = "step4txt">Step 4: Your calendar events are being imported. Please Wait</h3>
                <p><b>DO NOT CLOSE THIS TAB</b> while the import is completing!</p>
                <p>The events <b>will not all show up immediately</b> and the process may take up to 30 seconds.</p>
                <p>Make sure to reload your calendar if events are still missing.</p>
                <div class="spinner-border text-primary" role="status" style = "display: none; padding-top:10px" id = "loadingSpinner">
                      <span class="visually-hidden">Loading...</span>
                </div>
                <button id = "calendarButton" class="btn btn-primary" type="button" onclick="location.href = 'https://calendar.google.com';"
                        style = "display: none">Go to Google Calendar</button>
            </div>
        </div>
    </div>

    <br>

    <div class="d-flex justify-content-center">
        <h3 id = "step1" style = "display: none;">Step 1: Log Into Google </h3>
    </div>
    <br>
    <div id = "loginDiv" class ="d-flex justify-content-center">

        <button id = "authorize_button" style = "display: none;" class="btn btn-primary">Log Into Google</button>
        <button id = "signout_button" style = "display: none;" class = "btn btn-primary" >Sign Out</button>
    </div>
    <br>

    <script defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
    <script type="text/javascript" src = "{% static 'js/importSchedule.js' %}"></script>

</body>
</html>

